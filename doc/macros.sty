\newcommand{\aCmd}{E}
\newcommand{\bCmd}{D}

\newcommand{\ifnotempty}[2]{\ifx\relax#1\relax\else#2\fi}
\newcommand{\ifnotemptyelse}[3]{\ifx\relax#1\relax#3\else#2\fi}
\newcommand{\ifemptyelse}[3]{\ifx\relax#1\relax#2\else#3\fi}

\newcommand{\dontcare}{\texttt{\_}}
\newcommand{\pair}[2]{\langle#1,\,#2\rangle}
\newcommand{\freads}{\mathsf{reads}}
\newcommand{\fwrites}{\mathsf{writes}}
\newcommand{\rreads}{\mathsf{R}}
\newcommand{\rwrites}{\mathsf{W}}

\newcommand{\Reg}{\mathcal{R}}
\newcommand{\aReg}{r}
\newcommand{\bReg}{s}

\newcommand{\Loc}{\mathcal{X}}
\newcommand{\aLoc}{x}
\newcommand{\bLoc}{y}

\newcommand{\LVal}{\mathcal{L}}
\newcommand{\aLV}{\ell}
\newcommand{\bLV}{k}

\newcommand{\Val}{\mathcal{V}}
\newcommand{\aVal}{v}
\newcommand{\bVal}{w}

\newcommand{\Exp}{\mathcal{E}}
\newcommand{\aExp}{M}
\newcommand{\bExp}{N}

\newcommand{\Formulae}{\Phi}
\newcommand{\aForm}{\phi}
\newcommand{\bForm}{\psi}
\newcommand{\cForm}{\chi}
\newcommand{\TRUE}{\mathsf{true}}
\newcommand{\FALSE}{\mathsf{false}}

% \newcommand{\Rel}{\mathcal{A}_{\mathsf{rel}}}
% \newcommand{\Acq}{\mathcal{A}_{\mathsf{acq}}}
\newcommand{\Act}{\mathcal{A}}
\newcommand{\aAct}{a}
\newcommand{\bAct}{b}
\newcommand{\DRAcq}[2]{\mathsf{R_{acq}}\,#1\,#2}
\newcommand{\DWRel}[2]{\mathsf{W_{rel}}\,#1\,#2}
\newcommand{\DR}[2]{\mathsf{R}\,#1\,#2}
\newcommand{\DW}[2]{\mathsf{W}\,#1\,#2}
\newcommand{\DT}[1]{\mathsf{T}\,#1}
\newcommand{\DF}{\mathsf{F}}
\newcommand{\DB}{\mathsf{B}}
\newcommand{\DCn}[2]{\mathsf{C}\,#1_1\,#2_1,\,\ldots,\,#1_n\,#2_n}
\newcommand{\DC}[2]{\mathsf{C}\ifnotempty{#1}{\,#1\,#2}}

\newcommand{\Event}{E}
\newcommand{\aEv}{e}
\newcommand{\bEv}{d}
\newcommand{\cEv}{c}

\newcommand{\Alphabet}{\Sigma}
\newcommand{\labelling}{\lambda}

\newcommand{\RF}{\mathsf{RF}}

\newcommand{\NEVER}[1]{\rlap{$\times$}#1}

\newcommand{\fun}{\mathbin\rightarrow}
\newcommand{\prefix}{\mathbin\rightarrow}
\newcommand{\st}{\mathbin.}

\newcommand{\aPS}{P}
\newcommand{\aPSS}{\mathcal{P}}

\newcommand{\sem}[1]{\llbracket#1\rrbracket}
\newcommand{\REL}[1]{#1\ensuremath{_{\mathsf{rel}}}}
\newcommand{\ACQ}[1]{#1\ensuremath{_{\mathsf{acq}}}}
\newcommand{\FENCE}{\texttt{fence}}
\newcommand{\BEGIN}{\texttt{begin}\,}
%\newcommand{\IFCOMMITTHEN}{\texttt{if\,commit\,then}\,}
\newcommand{\IFCOMMITTHEN}{\texttt{if\,commit\,$\vec\aLoc$\,then}\,}
\newcommand{\END}{\texttt{end}\,}
\newcommand{\SKIP}{\texttt{skip}}
\newcommand{\GETS}{\texttt{:=}\,}
\newcommand{\SEMI}{\texttt{;}\,}
\newcommand{\IF}{\texttt{if}\,}
\newcommand{\THEN}{\,\texttt{then}\,}
\newcommand{\ELSE}{\,\texttt{else}\,}
\newcommand{\PAR}{\,\texttt{||}\,}
\newcommand{\VAR}{\texttt{var}\,}
\newcommand{\TOUCHED}{\texttt{touched}\,}

\newcommand{\SEC}{\texttt{SECRET}}

\usepackage{alltt}
\usepackage{tikz}
\usetikzlibrary{shapes.misc}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{topaths}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{matrix}
\usetikzlibrary{fit}

\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}

\pgfsetlayers{background,main,foreground}

\tikzstyle{event} = [draw=black, fill=blue!10, rectangle, rounded corners, minimum size=3ex]
\tikzstyle{po} = [->]
\tikzstyle{rf} = [->,thick,dashed,draw=black!50!green]

\tikzset{
    nonevent/.style={
        event, 
        append after command={
            node [
                fit=(\tikzlastnode),
                draw=red!50!black,
                thick,
                inner sep=-2\pgflinewidth,
                cross out
            ] {}
        }
    }
}


\newcommand{\event}[3]{\node[event](#1)[#3]{$\mathstrut#2$};}
\newcommand{\nonevent}[3]{\node[nonevent](#1)[#3]{$\mathstrut#2$};}
\newcommand{\po}[3][]{\draw[po,#1](#2)to(#3);}
\newcommand{\rf}[3][]{\draw[rf,#1](#2)to(#3);}
\newcommand{\rfx}[4][]{\draw[rf,#1](#2) edge node[above,text=black!50!green]{$#3$} (#4);}
